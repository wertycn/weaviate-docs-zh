---
authors:
- sebastian
date: 2022-09-27
description: Running ML Model Inference in production is hard. You can use Weaviate
  â€“ a vector database â€“ with Hugging Face Inference module to delegate the heavy lifting.
image: ./img/hero.png
slug: hugging-face-inference-api-in-weaviate
tags:
- integrations
title: Support for Hugging Face Inference API in Weaviate
---

![åœ¨ Weaviate ä¸­æ”¯æŒ Hugging Face æ¨ç† API](./img/hero.png)

<!-- truncate -->

å‘é‡æ•°æ®åº“ä½¿ç”¨æœºå™¨å­¦ä¹ æ¨¡å‹ä¸ºæ‚¨çš„æ•°æ®æä¾›ä»¤äººéš¾ä»¥ç½®ä¿¡çš„åŠŸèƒ½ã€‚æˆ‘ä»¬å¯ä»¥çœ‹åˆ°å„ç§ç”¨ä¾‹ï¼Œä»**æ‘˜è¦ç”Ÿæˆå™¨**ï¼ˆå¯ä»¥å°†ä»»ä½•æ–‡æœ¬æ‘˜è¦æˆä¸€å¥ç®€çŸ­çš„å¥å­ï¼‰ï¼Œåˆ°**è‡ªåŠ¨æ ‡è®°å™¨**ï¼ˆå¯ä»¥å¯¹æ•°æ®æ ‡è®°è¿›è¡Œåˆ†ç±»ï¼‰ï¼Œå†åˆ°**è½¬æ¢å™¨**å’Œ**å‘é‡åŒ–å™¨**ï¼ˆå¯ä»¥å°†ä»»ä½•æ•°æ® - æ–‡æœ¬ã€å›¾åƒã€éŸ³é¢‘ç­‰ - è½¬æ¢ä¸ºå‘é‡ï¼Œå¹¶ç”¨äºåŸºäºä¸Šä¸‹æ–‡çš„æŸ¥è¯¢ï¼‰ã€‚

æ‰€æœ‰è¿™äº›ç”¨ä¾‹éƒ½éœ€è¦è¿›è¡Œ`æœºå™¨å­¦ä¹ æ¨¡å‹æ¨ç†`- é€šè¿‡ä¸€ä¸ªMLæ¨¡å‹è¿è¡Œæ•°æ®å¹¶è®¡ç®—è¾“å‡ºçš„è¿‡ç¨‹ï¼ˆä¾‹å¦‚ï¼Œå°†ä¸€ä¸ªæ®µè½æ€»ç»“ä¸ºä¸€ä¸ªç®€çŸ­çš„å¥å­ï¼‰- è¿™æ˜¯ä¸€ä¸ªè®¡ç®—å¯†é›†å‹çš„è¿‡ç¨‹ã€‚

### é—®é¢˜ä¸­çš„éš¾é¢˜
åœ¨ç”Ÿäº§ç¯å¢ƒä¸­è¿è¡Œæ¨¡å‹æ¨ç†æ˜¯å›°éš¾çš„ã€‚
* éœ€è¦æ˜‚è´µçš„ä¸“ç”¨ç¡¬ä»¶ã€‚
* åœ¨åˆå§‹æ•°æ®å¯¼å…¥è¿‡ç¨‹ä¸­éœ€è¦æ›´å¤šçš„è®¡ç®—èƒ½åŠ›ã€‚
* ä¸€æ—¦å¤§éƒ¨åˆ†ç¹é‡çš„å·¥ä½œå®Œæˆï¼Œç¡¬ä»¶å¾€å¾€è¢«ä½æ•ˆåˆ©ç”¨ã€‚
* ä¸å…¶ä»–å›¢é˜Ÿå…±äº«å’Œä¼˜å…ˆå¤„ç†èµ„æºå¾ˆå›°éš¾ã€‚

å¥½æ¶ˆæ¯æ˜¯ï¼Œæœ‰ä¸€äº›å…¬å¸ï¼Œæ¯”å¦‚Hugging Faceã€OpenAIå’ŒCohereï¼Œæä¾›æ¨¡å‹æ¨ç†ä½œä¸ºä¸€é¡¹æœåŠ¡ã€‚

> "åœ¨ç”Ÿäº§ç¯å¢ƒä¸­è¿è¡Œæ¨¡å‹æ¨ç†æ˜¯å›°éš¾çš„ï¼Œ
è®©ä»–ä»¬ä¸ºæ‚¨å®Œæˆå§ã€‚"

## Weaviateå¯¹Hugging Faceæ¨ç†APIçš„æ”¯æŒ
ä»Weaviate `v1.15`å¼€å§‹ï¼ŒWeaviateåŒ…å«äº†ä¸€ä¸ªHugging Faceæ¨¡å—ï¼Œè¯¥æ¨¡å—å¯ä»¥ç›´æ¥ä»çŸ¢é‡æ•°æ®åº“ä¸­æä¾›å¯¹Hugging Face Inferenceçš„æ”¯æŒã€‚

Hugging Faceæ¨¡å—å…è®¸æ‚¨ä½¿ç”¨[Hugging Face InferenceæœåŠ¡](https://huggingface.co/inference-api#pricing)å’Œå¥å­ç›¸ä¼¼æ€§æ¨¡å‹ï¼Œç›´æ¥ä»Weaviateå¯¹æ•°æ®è¿›è¡Œå‘é‡åŒ–å’ŒæŸ¥è¯¢ã€‚æ— éœ€è‡ªè¡Œè¿è¡ŒInference APIã€‚

> æ‚¨å¯ä»¥é€‰æ‹©`text2vec-huggingface`ï¼ˆHugging Faceï¼‰å’Œ`text2vec-openai`ï¼ˆOpenAIï¼‰æ¨¡å—æ¥å§”æ‰˜æ‚¨çš„æ¨¡å‹æ¨ç†ä»»åŠ¡ã€‚<br/>
> è¿™ä¸¤ä¸ªæ¨¡å—åœ¨[Weaviateäº‘æœåŠ¡](/pricing)ä¸­éƒ½æ˜¯é»˜è®¤å¯ç”¨çš„ã€‚

## æ¦‚è¿°
![æ¦‚è¿°](./img/hugging-face-module-overview.png)

Hugging Faceæ¨¡å—éå¸¸ä»¤äººéš¾ä»¥ç½®ä¿¡ï¼Œæœ‰å¾ˆå¤šåŸå› ã€‚

### å…¬å…±æ¨¡å‹
æ‚¨å¯ä»¥è®¿é—®è¶…è¿‡1600ä¸ªé¢„è®­ç»ƒçš„[å¥å­ç›¸ä¼¼æ€§æ¨¡å‹](https://huggingface.co/models?pipeline_tag=sentence-similarity)ã€‚å¦‚æœå·²ç»æœ‰ä¸€ä¸ªé€‚ç”¨äºæ‚¨çš„ç”¨ä¾‹çš„æ¨¡å‹ï¼Œå°±ä¸éœ€è¦è®­ç»ƒè‡ªå·±çš„æ¨¡å‹ã€‚

å¦‚æœæ‚¨åœ¨é€‰æ‹©åˆé€‚çš„æ¨¡å‹æ–¹é¢é‡åˆ°å›°éš¾ï¼Œå¯ä»¥æŸ¥çœ‹æˆ‘ä»¬çš„åšå®¢æ–‡ç« [å¦‚ä½•ä»Hugging Faceé€‰æ‹©å¥å­è½¬æ¢å™¨](/blog/how-to-choose-a-sentence-transformer-from-hugging-face)ã€‚

### ç§æœ‰æ¨¡å‹
å¦‚æœæ‚¨æœ‰è‡ªå·±çš„æ¨¡å‹ï¼Œä¸“é—¨ä¸ºæ‚¨çš„æ•°æ®è¿›è¡Œè®­ç»ƒï¼Œé‚£ä¹ˆæ‚¨å¯ä»¥å°†å®ƒä»¬ä¸Šä¼ åˆ°Hugging Faceï¼ˆä½œä¸ºç§æœ‰æ¨¡å—ï¼‰ï¼Œå¹¶åœ¨Weaviateä¸­ä½¿ç”¨å®ƒä»¬ã€‚

<!-- TODO: æ›´æ–°æ–‡ç« é“¾æ¥ä¸€æ—¦å‡†å¤‡å¥½ -->
*æˆ‘ä»¬æ­£åœ¨ç¼–å†™ä¸€ç¯‡æ–‡ç« ï¼Œå°†æŒ‡å¯¼æ‚¨å¦‚ä½•åˆ›å»ºè‡ªå·±çš„æ¨¡å‹å¹¶å°†å…¶ä¸Šä¼ åˆ°Hugging Faceã€‚*

### å…¨è‡ªåŠ¨åŒ–å’Œä¼˜åŒ–
Weaviateä¼šä¸ºæ‚¨ç®¡ç†æ•´ä¸ªè¿‡ç¨‹ã€‚ä»ç¼–å†™ä»£ç çš„è§’åº¦æ¥çœ‹ï¼Œä¸€æ—¦æ‚¨æœ‰äº†æ¨¡å¼é…ç½®ï¼Œå‡ ä¹å¯ä»¥å¿˜è®°Hugging Faceçš„å­˜åœ¨ã€‚

ä¾‹å¦‚ï¼Œå½“æ‚¨å°†æ•°æ®å¯¼å…¥åˆ°Weaviateæ—¶ï¼ŒWeaviateä¼šè‡ªåŠ¨æå–ç›¸å…³çš„æ–‡æœ¬å­—æ®µï¼Œå°†å®ƒä»¬å‘é€ç»™Hugging Faceè¿›è¡Œå‘é‡åŒ–ï¼Œå¹¶å°†æ•°æ®ä¸æ–°çš„å‘é‡ä¸€èµ·å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ã€‚

### æœ€ç®€å•æ˜“ç”¨çš„å‡†å¤‡å°±ç»ª
æ¯ä¸ªä½¿ç”¨[Weaviate Cloud Services](/pricing)åˆ›å»ºçš„æ–°Weaviateå®ä¾‹éƒ½é»˜è®¤å¯ç”¨äº†Hugging Faceæ¨¡å—ã€‚æ‚¨æ— éœ€æ›´æ–°ä»»ä½•é…ç½®æ–‡ä»¶æˆ–å…¶ä»–å†…å®¹ï¼Œå®ƒå·²ç»å‡†å¤‡å°±ç»ªã€‚

å¦å¤–ï¼Œè¦åœ¨Weaviateå¼€æºç‰ˆï¼ˆ`v1.15`æˆ–æ›´æ–°ç‰ˆæœ¬ï¼‰ä¸­ä½¿ç”¨Hugging Faceæ¨¡å—ï¼Œæ‚¨åªéœ€å°†`text2vec-huggingface`è®¾ç½®ä¸ºé»˜è®¤çš„å‘é‡åŒ–å™¨ã€‚å¦‚ä¸‹æ‰€ç¤ºï¼š

```yaml
DEFAULT_VECTORIZER_MODULE: text2vec-huggingface
ENABLE_MODULES: text2vec-huggingface
```

## å¦‚ä½•å…¥é—¨

:::note
This article is not meant as a hands-on tutorial.
For more detailed instructions please check the [documentation](/developers/weaviate/modules/retriever-vectorizer-modules/text2vec-huggingface).
:::

ä½¿ç”¨Hugging Faceæ¨¡å‹ä¸Weaviateçš„æ•´ä½“è¿‡ç¨‹éå¸¸ç®€å•ã€‚

![ä½¿ç”¨Hugging Faceæ¨¡å‹çš„æ­¥éª¤](./img/how-to-get-started-recipe.png)
å¦‚æœè¿™æ˜¯ä¸€å ‚çƒ¹é¥ªè¯¾ï¼Œæ‚¨æ­£åœ¨æŒ‰ç…§é£Ÿè°±æ“ä½œã€‚

æ‚¨éœ€è¦å‡†å¤‡ä»¥ä¸‹ææ–™ï¼š
* åŸå§‹æ•°æ®
* Hugging Face APIä»¤ç‰Œ - æ‚¨å¯ä»¥ä»[å®˜æ–¹ç½‘ç«™](https://huggingface.co/settings/tokens)ä¸Šç”³è¯·
* å·²å¯ç”¨â€œtext2vec-huggingfaceâ€çš„å¯å·¥ä½œçš„Weaviateå®ä¾‹

ç„¶åæ‚¨å°†æŒ‰ç…§ä»¥ä¸‹æ­¥éª¤è¿›è¡Œæ“ä½œã€‚

### ç¬¬1æ­¥ - åˆå§‹å‡†å¤‡ - åˆ›å»ºæ¨¡å¼å’Œé€‰æ‹©hfæ¨¡å‹
ä¸€æ—¦æ‚¨å¯åŠ¨å¹¶è¿è¡Œäº†Weaviateå®ä¾‹ã€‚
å®šä¹‰æ‚¨çš„æ¨¡å¼ï¼ˆæ ‡å‡†çš„æ“ä½œ - é€‰æ‹©ç±»åã€å±æ€§å’Œæ•°æ®ç±»å‹ï¼‰ã€‚ä½œä¸ºæ¨¡å¼å®šä¹‰çš„ä¸€éƒ¨åˆ†ï¼Œæ‚¨è¿˜éœ€è¦æä¾›æ¯ä¸ªæ¨¡å¼ç±»åˆ«æ‰€è¦ä½¿ç”¨çš„Hugging Faceæ¨¡å‹ã€‚

é€šè¿‡å‘æ¨¡å¼å®šä¹‰ä¸­æ·»åŠ ä¸€ä¸ª`moduleConfig`å±æ€§å’Œ`model`åç§°æ¥å®Œæˆæ­¤æ“ä½œï¼Œå¦‚ä¸‹æ‰€ç¤ºï¼š
```javascript
{
    "class": "Notes",
    "moduleConfig": {
        "text2vec-huggingface": {
            "model": "sentence-transformers/all-MiniLM-L6-v2",  # model name
            ...
        }
    },
    "vectorizer": "text2vec-huggingface",  # vectorizer for hugging face
   ...
}
```

*å¦‚æœä½ æƒ³çŸ¥é“çš„è¯ï¼Œæ˜¯çš„ï¼Œä½ å¯ä»¥ä¸ºæ¯ä¸ªç±»åˆ«ä½¿ç”¨ä¸åŒçš„æ¨¡å‹ã€‚*

### ç¬¬äºŒæ­¥ - ç…®ä¸€æ®µæ—¶é—´ - å¯¼å…¥æ•°æ®
å¼€å§‹å°†æ•°æ®å¯¼å…¥åˆ°Weaviateä¸­ã€‚

ä¸ºæ­¤ï¼Œæ‚¨éœ€è¦æ‚¨çš„Hugging Face APIä»¤ç‰Œï¼Œè¯¥ä»¤ç‰Œç”¨äºæˆæƒæ‰€æœ‰ä¸ğŸ¤—çš„è°ƒç”¨ã€‚

å°†æ‚¨çš„ä»¤ç‰Œæ·»åŠ åˆ°Weaviateå®¢æˆ·ç«¯é…ç½®ä¸­ã€‚ä¾‹å¦‚ï¼Œåœ¨Pythonä¸­ï¼Œæ‚¨å¯ä»¥åƒè¿™æ ·åšï¼š

```javascript
client = weaviate.Client(
    url='http://localhost:8080',
    additional_headers={
        'X-HuggingFace-Api-Key': 'YOUR-HUGGINGFACE-API-KEY'
    }
)
```
ç„¶åæŒ‰ç…§ä»¥å¾€çš„æ–¹å¼å¯¼å…¥æ•°æ®ã€‚Weaviateå°†å¤„ç†ä¸Hugging Faceçš„æ‰€æœ‰é€šä¿¡ã€‚

### ç¬¬3æ­¥ - æœåŠ¡éƒ¨åˆ† - æŸ¥è¯¢æ•°æ®
ä¸€æ—¦å¯¼å…¥äº†éƒ¨åˆ†æˆ–å…¨éƒ¨æ•°æ®ï¼Œæ‚¨å°±å¯ä»¥å¼€å§‹è¿è¡ŒæŸ¥è¯¢ã€‚
ï¼ˆæ˜¯çš„ï¼Œåœ¨å¯¼å…¥è¿‡ç¨‹ä¸­ï¼Œæ‚¨ç”šè‡³å¯ä»¥å¼€å§‹æŸ¥è¯¢æ‚¨çš„æ•°æ®åº“ï¼‰ã€‚

è¿è¡ŒæŸ¥è¯¢ä¹Ÿéœ€è¦ç›¸åŒçš„ä»¤ç‰Œã€‚
ä½†æ˜¯æ‚¨å¯ä»¥é‡ç”¨åŒä¸€ä¸ªå®¢æˆ·ç«¯ï¼Œæ‰€ä»¥æ‚¨å¯ä»¥å¼€å§‹äº†ã€‚

ç„¶åï¼Œæ‚¨åªéœ€æŒ‰ç…§é€šå¸¸çš„æ–¹å¼è¿è¡ŒæŸ¥è¯¢ï¼š
```javascript
nearText = {
    "concepts": ["How to use Hugging Face modules with Weaviate?"],
    "distance": 0.6,
}

result = (
    client.query
    .get("Notes", [
        "name",
        "comment",
        "_additional {certainty distance} "])
    .with_near_text(nearText)
    .do()
)
```

## æ‘˜è¦
> ç°åœ¨æ‚¨å¯ä»¥åœ¨Weaviateä¸­ä½¿ç”¨[Hugging Face](/developers/weaviate/modules/retriever-vectorizer-modules/text2vec-huggingface)æˆ–[OpenAI](/developers/weaviate/modules/retriever-vectorizer-modules/text2vec-openai)æ¨¡å—æ¥å§”æ‰˜æ¨¡å‹æ¨ç†ã€‚

åªéœ€é€‰æ‹©æ¨¡å‹ï¼Œæä¾›æ‚¨çš„APIå¯†é’¥ï¼Œå³å¯å¼€å§‹å¤„ç†æ‚¨çš„æ•°æ®ã€‚

Weaviateä¸ºæ‚¨ä¼˜åŒ–äº†ä¸æ¨ç†APIçš„é€šä¿¡è¿‡ç¨‹ï¼Œè¿™æ ·æ‚¨å°±å¯ä»¥ä¸“æ³¨äºåº”ç”¨ç¨‹åºçš„æŒ‘æˆ˜å’Œéœ€æ±‚ã€‚æ— éœ€è‡ªå·±è¿è¡Œæ¨ç†APIã€‚

## æ¥ä¸‹æ¥åšä»€ä¹ˆ
æŸ¥çœ‹[text2vec-huggingface](/developers/weaviate/modules/retriever-vectorizer-modules/text2vec-huggingface)æ–‡æ¡£ï¼Œäº†è§£æ›´å¤šå…³äºæ–°æ¨¡å—çš„ä¿¡æ¯ã€‚

å¦‚æœæ‚¨æ˜¯Weaviateçš„æ–°æ‰‹ï¼Œè¯·æŸ¥çœ‹[å…¥é—¨æŒ‡å—](/developers/weaviate/quickstart)ã€‚

å¦‚æœæ‚¨è§‰å¾—è¿™ç¯‡æ–‡ç« æœ‰è¶£æˆ–æœ‰ç”¨ï¼Œè¯·å‘Šè¯‰æˆ‘ä»¬ã€‚æˆ‘ä»¬éå¸¸ä¹æ„æ¥æ”¶å»ºè®¾æ€§çš„åé¦ˆæ„è§ã€‚ğŸ˜€

æˆ‘ä»¬ä¸€ç›´åœ¨æ’°å†™æ–°çš„æ–‡ç« ï¼Œå¹¶ä¸”æ­£åœ¨å¯»æ‰¾æ–°çš„ä¸»é¢˜ã€‚å¦‚æœæœ‰ä»»ä½•æ‚¨å¸Œæœ›æˆ‘ä»¬å†™çš„å†…å®¹ï¼Œè¯·å‘Šè¯‰æˆ‘ä»¬ã€‚ğŸ¤—

import ShareFeedback from '/_includes/share-feedback.md';

<ShareFeedback />